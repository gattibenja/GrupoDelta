<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>productos</title>
    <link rel="stylesheet" href="/css/producto/productosStyles.css">
</head>
<body>

    <header class="header-principal">
        <div class="logo">
            <img src="../../imagenes/logo.svg" alt="Logo">
        </div>
        <nav>
            <ul>
                <li><a href="/Paginas/Index/index.html">Inicio</a></li>
                <li><a href="/Paginas/productos/productos.html">Catálogo</a></li>
                <li><a href="/Paginas/Contacto/contacto.html">Contacto</a></li>
            </ul>
        </nav>
        <div class="carritoCompra">
            <a href="../carrito/carrito.html"><img src="../../imagenes/carro-de-la-compra.png" alt=""></a>
        </div>
    </header>

    <main>
        <section class="catalogo">
            <h1>Catálogo de Productos</h1>
            <div id="productos-container" class="productos-container">        
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-container"> 
            <p class="info"><a href="https://www.hermanosjota.com.ar">Acerca de nosotros</a></p>
            <p class="info"><a href="mailto:info@hermanosjota.com.ar">Términos y condiciones</a></p>
            <p class="info"><a href="mailto:ventas@hermanosjota.com.ar">Política de privacidad</a></p>
            <p class="info"><a href="https://www.instagram.com/hermanosjota_ba" target="_blank">Preguntas frecuentes</a></p>
        </div>
        <div class="copy">
            <p class="footer-copyright"> &copy; 2025 Hermanos Jota. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
      fetch("/productos.json")
        .then(function(res) { return res.json(); })
        .then(function(productos) {
          var contenedor = document.getElementById("productos-container");

          productos.forEach(function(producto) {
            var article = document.createElement("article");
            article.classList.add("producto");

            article.innerHTML = 
              '<img src="' + producto.imagen + '" alt="' + producto.nombre + '">' +
              '<h2>' + producto.nombre + '</h2>' +
              '<p class="descripcion">' + producto.descripcion + '</p>' +
              '<p class="precio">$' + (producto.precio ? producto.precio.toLocaleString("es-AR") : "") + '</p>' +
              '<div class="botones-producto">' +
                '<button class="btn-agregar">Agregar al carrito</button>' +
                '<button class="btn-info">Ver más información</button>' +
              '</div>';

            article.querySelector(".btn-agregar").addEventListener("click", function() {
              agregarAlCarrito(producto);
            });

            article.querySelector(".btn-info").addEventListener("click", function() {
              window.location.href = "/Paginas/detailProduct/detailUno.html?id=" + producto.id;
            });

            contenedor.appendChild(article);
          });
        })
        .catch(function(err) { console.error("Error cargando productos:", err); });

      function obtenerCarrito() {
        return JSON.parse(localStorage.getItem("carrito")) || [];
      }

      function guardarCarrito(carrito) {
        localStorage.setItem("carrito", JSON.stringify(carrito));
      }

      function agregarAlCarrito(producto) {
        var carrito = obtenerCarrito();
        var index = -1;
        for (var i = 0; i < carrito.length; i++) {
          if (carrito[i].id === producto.id) {
            index = i;
            break;
          }
        }

        if (index >= 0) {
          carrito[index].cantidad++;
        } else {
          producto.cantidad = 1;
          carrito.push(producto);
        }
        guardarCarrito(carrito);
        alert("Producto agregado al carrito: " + producto.nombre);
      }
    </script>
</body>
</html>
